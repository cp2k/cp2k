
How to compile CP2K code
========================

 1) Acquire the code:

    The preferred method is to download it from the CVS, 
    using http://cp2k.berlios.de/
    put the code in ~/cp2k/ or equivalent

 2a) gnu make should be on your system (gmake or make on linux), 
     go to http://www.gnu.org/software/make/make.html to get it

 2b) a f90 compiler, BLAS and LAPACK should be installed
     http://www.netlib.org/blas/
     http://www.netlib.org/lapack/
     http://math-atlas.sourceforge.net/
     using vendor provided libraries can make a very significant difference (e.g. mkl, essl)

 2c) MPI and SCALAPACK might be needed for parallel runs
     http://www-unix.mcs.anl.gov/mpi/mpich/
     http://www.netlib.org/scalapack/

 2d) fftw could be an advantage but is not needed
     the current version of the code needs FFTW 2.X
     http://www.fftw.org/

 3) to compile the code use : 

    > cd cp2k/makefiles; make sopt; make popt 

    "p" stands for parallel (alternatively "s" = serial)
    "opt" means to buil an optimised version (alternatively "dbg" = debugging)
    (make stands for GNU make)

 3b) These easily fails, but there are a number of easy fixes (step 4,5)

 4) In the likely order of occurence :

    - ~/cp2k/arch/*.* files have some paths to libraries hard-wired 
       (e.g. blass, lapack, ...). 
       be sure to remove e.g. __FFTW if you don not have it. __FFTSG 
       is always there. 

    - ~/cp2k/tools/get_arch_code returns unknown for the architecture
      try to have it return the closest possible match.
      have a look in ~/cp2k/arch for the possible options (or see step 7)
      different compilers (e.g. INTEL ifc, PGI pgf90, NAG f95, ...) can often also be selected

    - your compiler is broken. Many, many bad f90 compilers are still around, 
      and the latest version is not always the best one. Especially the PC 
      platform seems to be affected (and a different compiler (version) can be twice as fast)

 5) If your machine is really not there, it shouldn't be too difficult to add.
    Only ~/cp2k/src/machine*.F should be affected.

 6) If compilation works fine, you can run one of the test cases 
    to try out the executable

>  cd ~/cp2k/tests/QS/
> ~/cp2k/exe/YOURMACHINE/cp2k.sopt H2O.inp

 6b) you could have a look in ~/cp2k/doc if your run fails

 7) In any case please tell us your comments, praise, criticism, thanks, ...

    you can sent email to the people in the team :

    http://developer.berlios.de/project/memberlist.php?group_id=129

 8) Happy computing!

 the cp2k team.
