&GLOBAL
  CALLGRAPH
  EXTENDED_FFT_LENGTHS
  PRINT_LEVEL MEDIUM
  PROJECT pao_ml_md
  RUN_TYPE MD
  WALLTIME 84600
&END GLOBAL

&MOTION
  &GEO_OPT
    MAX_ITER 100
    OPTIMIZER LBFGS
    &LBFGS
      TRUST_RADIUS 0.025
    &END LBFGS
  &END GEO_OPT
  &MD
    ENSEMBLE NVE
    STEPS 20
    TEMPERATURE 300
    TIMESTEP 0.5
  &END MD
  &PRINT
    &FORCES
      &EACH
        MD 1
      &END EACH
    &END FORCES
    &RESTART
      BACKUP_COPIES 3
      &EACH
        MD 1
      &END EACH
    &END RESTART
    &RESTART_HISTORY
      &EACH
        MD 10
      &END EACH
    &END RESTART_HISTORY
    &TRAJECTORY
      &EACH
        MD 1
      &END EACH
    &END TRAJECTORY
    &VELOCITIES
      &EACH
        MD 1
      &END EACH
    &END VELOCITIES
  &END PRINT
&END MOTION

&FORCE_EVAL
  METHOD Quickstep
  &DFT
    BASIS_SET_FILE_NAME BASIS_MOLOPT
    BASIS_SET_FILE_NAME BASIS_BENCH_ONLY
    PLUS_U_METHOD MULLIKEN_CHARGES
    POTENTIAL_FILE_NAME GTH_POTENTIALS
    &LS_SCF
      EPS_FILTER 1E-7
      EPS_SCF 1E-9
      MATRIX_CLUSTER_TYPE MOLECULAR
      MAX_SCF 50
      MIXING_FRACTION 0.20
      PURIFICATION_METHOD TRS4
      REPORT_ALL_SPARSITIES .FALSE.
      S_PRECONDITIONER NONE
      &CURVY_STEPS
      &END CURVY_STEPS
      &PAO
        EPS_PAO 2.0E-7
        MAX_CYCLES 4000
        MAX_PAO 0
        MIXING 0.5
        PARAMETERIZATION ROTINV
        PENALTY_STRENGTH 0.0
        !
        !          learning settings
        !
        !          MIXING 0.3
        !          MAX_PAO 200000
        !          RESTART_FILE test2-1_0.pao
        !          REGULARIZATION 1.0E-3
        !          PRECONDITION YES
        !          ! PREOPT_DM_FILE test_LS_DM_SPIN_1_RESTART.dm
        !          LINPOT_PRECONDITION_DELTA 0.01
        !          LINPOT_INITGUESS_DELTA 1E+10 ! use zero as initial guess
        !          LINPOT_REGULARIZATION_DELTA 1E-6
        !          LINPOT_REGULARIZATION_STRENGTH 1E-3
        &LINE_SEARCH
          METHOD ADAPT
        &END LINE_SEARCH
        &MACHINE_LEARNING
          DESCRIPTOR OVERLAP
          GP_NOISE_VAR 0.0001
          GP_SCALE 0.15
          METHOD GAUSSIAN_PROCESS
          PRIOR MEAN
          TOLERANCE 1000.0
          &TRAINING_SET
            test-1_0.pao
            test2-1_0.pao
          &END TRAINING_SET
        &END MACHINE_LEARNING
        &PRINT
          &FOCK_GAP
            FILENAME gap_md
          &END FOCK_GAP
          &ML_VARIANCE
            FILENAME variance_md
          &END ML_VARIANCE
          &RESTART
            BACKUP_COPIES 10
          &END RESTART
        &END PRINT
      &END PAO
    &END LS_SCF
    &MGRID
      CUTOFF 400
      NGRIDS 5
      &RS_GRID
        DISTRIBUTION_TYPE DISTRIBUTED
        MAX_DISTRIBUTED_LEVEL 4
      &END RS_GRID
    &END MGRID
    &QS
      EPS_DEFAULT 1.0E-10
      LS_SCF
    &END QS
    &XC
      &XC_FUNCTIONAL
        &PBE
        &END PBE
      &END XC_FUNCTIONAL
    &END XC
  &END DFT
  &SUBSYS
    &CELL
      A 1.6435080453012679E+02 0.0000000000000000E+00 0.0000000000000000E+00
      B 0.0000000000000000E+00 9.1184805784152502E+01 0.0000000000000000E+00
      C 0.0000000000000000E+00 0.0000000000000000E+00 8.0351424919394375E+01
      MULTIPLE_UNIT_CELL 1 1 1
    &END CELL
    &COORD
      @INCLUDE 'tio2_in_acn.xyz'
    &END COORD
    &KIND HC
      BASIS_SET DZVP-MOLOPT-GTH
      ELEMENT H
      PAO_BASIS_SIZE 1
      POTENTIAL GTH-PBE-q1
      &PAO_DESCRIPTOR
        BETA 0.16
        SCREENING 0.66
        WEIGHT 2.20
      &END PAO_DESCRIPTOR
      &PAO_POTENTIAL
        BETA 3.04
        MAXL 4
        WEIGHT 2.76
      &END PAO_POTENTIAL
    &END KIND
    &KIND CT
      BASIS_SET DZVP-MOLOPT-GTH
      ELEMENT C
      PAO_BASIS_SIZE 4
      POTENTIAL GTH-PBE-q4
      &PAO_DESCRIPTOR
        BETA 0.08
        SCREENING 0.66
        WEIGHT 2.55
      &END PAO_DESCRIPTOR
      &PAO_POTENTIAL
        BETA 1.91
        MAXL 4
        WEIGHT 4.96
      &END PAO_POTENTIAL
    &END KIND
    &KIND YC
      BASIS_SET DZVP-MOLOPT-GTH
      ELEMENT C
      PAO_BASIS_SIZE 4
      POTENTIAL GTH-PBE-q4
      &PAO_DESCRIPTOR
        BETA 0.08
        SCREENING 0.66
        WEIGHT 2.55
      &END PAO_DESCRIPTOR
      &PAO_POTENTIAL
        BETA 1.91
        MAXL 4
        WEIGHT 4.96
      &END PAO_POTENTIAL
    &END KIND
    &KIND YN
      BASIS_SET DZVP-MOLOPT-GTH
      ELEMENT N
      PAO_BASIS_SIZE 4
      POTENTIAL GTH-PBE-q5
      &PAO_DESCRIPTOR
        BETA 0.095
        SCREENING 0.66
        WEIGHT 3.04
      &END PAO_DESCRIPTOR
      &PAO_POTENTIAL
        BETA 1.91
        MAXL 4
        WEIGHT 4.96
      &END PAO_POTENTIAL
    &END KIND
    &KIND Ti
      BASIS_SET TIO2-BASIS
      PAO_BASIS_SIZE 10
      POTENTIAL GTH-PBE-q12
      &DFT_PLUS_U
        L 2
        U_MINUS_J [eV] 6.5
      &END DFT_PLUS_U
      &PAO_DESCRIPTOR
        BETA 0.086
        SCREENING 0.66
        WEIGHT 1.54
      &END PAO_DESCRIPTOR
      &PAO_POTENTIAL
        BETA 1.91
        MAXL 4
        WEIGHT 4.96
      &END PAO_POTENTIAL
    &END KIND
    &KIND O
      BASIS_SET TIO2-BASIS
      PAO_BASIS_SIZE 4
      POTENTIAL GTH-PBE-q6
      &PAO_DESCRIPTOR
        BETA 0.099
        SCREENING 0.66
        WEIGHT 3.44
      &END PAO_DESCRIPTOR
      &PAO_POTENTIAL
        BETA 1.91
        MAXL 4
        WEIGHT 4.96
      &END PAO_POTENTIAL
    &END KIND
    &TOPOLOGY
      CONNECTIVITY USER
      PARA_RES .FALSE.
    &END TOPOLOGY
  &END SUBSYS
&END FORCE_EVAL
